# Stock Scoring System Configuration
# Based on professional hedge fund methodologies

# Category Weights (Phase 3 - with advanced features)
weights:
  trend_momentum: 0.26 
  volume: 0.10
  fundamental: 0.22
  market_context: 0.21
  advanced:  0.20  # Phase 3: Earnings, analyst, short interest, options

# Technical Indicator Parameters
technical:
  ma:
    short_period: 50
    long_period: 200

  momentum:
    lookback_days: 252  # ~12 months
    skip_recent_days: 21  # Skip most recent month

  rsi:
    period: 14
    standard_overbought: 70
    standard_oversold: 30
    volatile_overbought: 80
    volatile_oversold: 20
    high_beta_threshold: 1.5

  macd:
    fast_period: 12
    slow_period: 26
    signal_period: 9

# Volume Analysis Parameters
volume:
  recent_period: 15  # Days for recent average
  previous_period: 15  # Days for previous average
  accumulation_threshold_min: 0.10  # 10% increase
  accumulation_threshold_max: 0.20  # 20% increase
  distribution_threshold: 0.30  # 30% increase
  price_volume_period: 20  # Days for volume average

# Fundamental Thresholds
fundamental:
  pe:
    value: 15
    fair: 25
    speculative: 50

  peg:
    attractive: 1.0
    fair: 2.0

  roe:
    quality_threshold: 15.0  # 15%

  debt_equity:
    healthy_threshold: 1.0
    veto_threshold: 3.0  # Automatic veto

  cash_flow_quality:
    quality_threshold: 1.0
    veto_threshold: 0.5  # For 3+ consecutive quarters

# Market Context Parameters
market:
  vix:
    extreme_fear: 30
    moderate_fear: 20
    normal_low: 12

  sector_relative:
    outperform_threshold: 5.0  # 5%
    underperform_threshold: -5.0  # -5%
    lookback_days: 60

  regime:
    ma_period: 200  # Days for S&P 500 moving average

# Scoring Ranges (for normalization)
score_ranges:
  trend_max: 6.0
  volume_max: 3.0
  fundamental_max: 5.0
  market_max: 4.0
  advanced_max: 10.0  # Phase 3: Max raw score from advanced indicators

# Signal Thresholds
signals:
  strong_buy: 6.0
  buy: 3.0
  neutral_high: 3.0
  neutral_low: -3.0
  sell: -6.0

# Position Sizing (% of portfolio)
position_sizing:
  score_7_plus: 5.0
  score_5_plus: 3.0
  score_3_plus: 1.5
  score_below_3: 0.5
  max_position: 5.0  # Maximum position size

  # Volatility adjustments
  high_beta_threshold: 1.5
  high_beta_multiplier: 0.7
  low_beta_threshold: 0.7
  low_beta_multiplier: 1.3

  # Market regime adjustments
  bear_market_multiplier: 0.8
  bull_market_multiplier: 1.1

# Automatic Veto Rules
vetoes:
  min_avg_volume: 500000  # Minimum average daily volume
  min_market_cap: 300000000  # $300 million
  earnings_days_before: 7  # Days before earnings to avoid
  max_decline_60d: 0.50  # 50% decline in 60 days
  min_negative_earnings_quarters: 4  # Consecutive quarters
  max_debt_equity: 3.0
  min_cash_flow_quality_quarters: 3  # For veto threshold

# Confidence Adjustments
confidence:
  strong_agreement_threshold: 3  # Categories agreeing
  strong_agreement_multiplier: 1.3
  major_conflict_multiplier: 0.7
  high_vix_threshold: 40
  high_vix_multiplier: 0.8
  trend_fundamental_conflict_threshold_trend: 30
  trend_fundamental_conflict_threshold_fundamental: -20
  trend_fundamental_conflict_multiplier: 0.75

# Sector to ETF Mapping
sector_etfs:
  Technology: XLK
  Financials: XLF
  Finance: XLF
  Financial Services: XLF
  Energy: XLE
  Healthcare: XLV
  Health Care: XLV
  Industrials: XLI
  Consumer Discretionary: XLY
  Consumer Cyclical: XLY
  Utilities: XLU
  Utility: XLU
  Materials: XLB
  Basic Materials: XLB
  Real Estate: XLRE
  Communication Services: XLC
  Communication: XLC
  Telecommunication Services: XLC
  Consumer Staples: XLP
  Consumer Defensive: XLP
  default: SPY

# Data Cache Settings
cache:
  enabled: true
  cache_dir: cache
  cache_duration_hours: 24
  price_cache_duration_hours: 1  # More frequent refresh for price data

# Market Indices
indices:
  sp500: ^GSPC
  vix: ^VIX

# Phase 3: Advanced Features Configuration
advanced_features:
  # Earnings Quality Analysis
  earnings_quality:
    consecutive_beat_threshold: 3  # Quarters with earnings beats
    consecutive_miss_threshold: 3  # Quarters with earnings misses
    strong_yoy_growth_threshold: 15.0  # 15% YoY growth = bonus
    weak_yoy_growth_threshold: -10.0  # Negative growth = penalty

  # Analyst Revisions
  analyst_revisions:
    lookback_days: 30  # Track upgrades/downgrades in last 30 days
    significant_upgrade_threshold: 3  # Net upgrades for max score
    significant_downgrade_threshold: 3  # Net downgrades for min score

  # Short Interest Analysis
  short_interest:
    enabled: true
    high_threshold: 20.0  # 20%+ short float = squeeze potential
    moderate_threshold: 10.0  # 10-20% = moderate
    low_threshold: 2.0  # <2% = very low interest
    days_to_cover_high: 5.0  # 5+ days = potential squeeze

  # Options Flow Analysis
  options_flow:
    enabled: true
    unusual_volume_multiplier: 2.0  # Volume > 2x open interest
    bullish_pc_ratio_threshold: 0.7  # P/C < 0.7 = bullish
    bearish_pc_ratio_threshold: 1.3  # P/C > 1.3 = bearish
    neutral_pc_min: 1.0  # Neutral range
    neutral_pc_max: 1.3

# Phase 2: Sector-Specific Adjustments
# Each sector gets custom weight multipliers and threshold overrides
sector_adjustments:
  Technology:
    weight_multipliers:
      trend_momentum: 1.2  # Tech stocks = momentum heavy
      fundamental: 0.9     # Less emphasis on traditional valuation
    threshold_overrides:
      pe_fair: 35          # Higher P/E acceptable for tech
      pe_expensive: 60
      peg_attractive: 1.5  # Growth-adjusted valuation more important

  Financials:
    weight_multipliers:
      fundamental: 1.3     # Fundamentals critical for banks
      trend_momentum: 0.9  # Less momentum-driven
    threshold_overrides:
      roe_quality: 12.0    # Lower ROE threshold for financials
      debt_equity_healthy: 3.0  # Banks naturally have higher leverage

  Financial Services:
    weight_multipliers:
      fundamental: 1.3
      trend_momentum: 0.9
    threshold_overrides:
      roe_quality: 12.0
      debt_equity_healthy: 3.0

  Healthcare:
    weight_multipliers:
      fundamental: 1.2     # Quality matters
      market_context: 0.9  # More defensive, less market-driven
    threshold_overrides:
      pe_fair: 30          # Pharma can have higher P/E
      roe_quality: 12.0    # R&D heavy companies

  Health Care:
    weight_multipliers:
      fundamental: 1.2
      market_context: 0.9
    threshold_overrides:
      pe_fair: 30
      roe_quality: 12.0

  Energy:
    weight_multipliers:
      market_context: 1.3  # Highly cyclical
      volume: 1.2          # Institutional flows important
      fundamental: 0.9
    threshold_overrides:
      debt_equity_healthy: 1.5  # Capital intensive industry

  Consumer Cyclical:
    weight_multipliers:
      market_context: 1.2  # Economic cycle sensitive
      trend_momentum: 1.1
    threshold_overrides:
      pe_fair: 28

  Consumer Discretionary:
    weight_multipliers:
      market_context: 1.2
      trend_momentum: 1.1
    threshold_overrides:
      pe_fair: 28

  Consumer Defensive:
    weight_multipliers:
      fundamental: 1.2     # Quality and stability matter
      trend_momentum: 0.9  # Less momentum-driven
      market_context: 0.9  # More defensive
    threshold_overrides:
      roe_quality: 12.0

  Consumer Staples:
    weight_multipliers:
      fundamental: 1.2
      trend_momentum: 0.9
      market_context: 0.9
    threshold_overrides:
      roe_quality: 12.0

  Industrials:
    weight_multipliers:
      volume: 1.1          # Institutional interest important
      market_context: 1.1  # Economic cycle sensitive
    threshold_overrides:
      debt_equity_healthy: 1.2

  Basic Materials:
    weight_multipliers:
      market_context: 1.3  # Highly cyclical
      volume: 1.2
      fundamental: 0.8     # Less emphasis on P/E (cyclical earnings)
    threshold_overrides:
      debt_equity_healthy: 1.3

  Materials:
    weight_multipliers:
      market_context: 1.3
      volume: 1.2
      fundamental: 0.8
    threshold_overrides:
      debt_equity_healthy: 1.3

  Real Estate:
    weight_multipliers:
      fundamental: 1.3     # Cash flow and debt critical
      volume: 0.9
    threshold_overrides:
      debt_equity_healthy: 2.0  # REITs have higher leverage
      cash_flow_quality: 0.9    # Different cash flow dynamics

  Utilities:
    weight_multipliers:
      fundamental: 1.2     # Stable cash flows matter
      trend_momentum: 0.8  # Very low momentum
      market_context: 0.9  # Defensive sector
    threshold_overrides:
      debt_equity_healthy: 2.0  # Capital intensive
      pe_fair: 20          # Lower valuation multiples
      roe_quality: 10.0

  Utility:
    weight_multipliers:
      fundamental: 1.2
      trend_momentum: 0.8
      market_context: 0.9
    threshold_overrides:
      debt_equity_healthy: 2.0
      pe_fair: 20
      roe_quality: 10.0

  Communication Services:
    weight_multipliers:
      trend_momentum: 1.1
      volume: 1.1
    threshold_overrides:
      pe_fair: 30

  Communication:
    weight_multipliers:
      trend_momentum: 1.1
      volume: 1.1
    threshold_overrides:
      pe_fair: 30

  Telecommunication Services:
    weight_multipliers:
      trend_momentum: 1.1
      volume: 1.1
    threshold_overrides:
      pe_fair: 30

# Phase 2: Optimized Weights (to be populated by weight optimizer)
optimized_weights:
  bull_market:
    trend_momentum: 0.40
    volume: 0.15
    fundamental: 0.20
    market_context: 0.25

  bear_market:
    trend_momentum: 0.30
    volume: 0.20
    fundamental: 0.30
    market_context: 0.20

# Phase 2: Backtesting Configuration
backtesting:
  default_tickers: [AAPL, MSFT, TSLA, NVDA, JPM, XOM, PFE, WMT]
  lookback_years: 3
  holding_period_days: 60  # ~2-3 months
  rebalance_frequency_days: 30
  start_date: "2022-01-01"
  end_date: "2025-01-01"
